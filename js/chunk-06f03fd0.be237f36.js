(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06f03fd0","chunk-3ff807a0"],{1886:function(t,e,i){"use strict";i("d373")},"47dc":function(t,e,i){},b035:function(t,e,i){"use strict";i("47dc")},d373:function(t,e,i){},dded:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chart"},[i("div",{style:{width:t.size.width,height:t.size.height},attrs:{id:"chart1"}}),i("div",{style:{width:t.size.width,height:t.size.height},attrs:{id:"chart2"}})])},o=[],r={data:function(){return{size:{width:"600px",height:"300px"},chart1:null,chart2:null,chartOptions1:{title:{textStyle:{color:"#999"}},grid:{left:0,top:25,right:10,bottom:20},toolbox:{show:!0,feature:{dataZoom:{yAxisIndex:"none",iconStyle:{shadowColor:"rgba(0, 0, 0, 0.1)",shadowBlur:10,borderType:"dotted"}},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{}}},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},xAxis:{data:[],zlevel:1,gridIndex:0,axisLabel:{align:"left"}},yAxis:[{},{type:"value",axisLabel:{inside:!0,verticalAlign:"bottom"},axisTick:{inside:!0},name:"account",max:"dataMax",min:"dataMin",axisLine:{lineStyle:{color:"#999"}},splitLine:{show:!0,lineStyle:{color:["rgba(80,80,80, 0.7)"],type:"dashed"}}}],legend:{data:[{name:"assets"},{name:"benchmark"}],x:"left",top:"5%",textStyle:{color:"#999"}},dataZoom:[{type:"slider",show:!1,fillerColor:"#999",realtime:!0,start:0,end:100,backgroundColor:"#303030",showDataShadow:!1}],series:[{name:"assets",type:"line",data:[],lineStyle:{normal:{color:"#c23531"}},areaStyle:{normal:{color:"#c23531",opacity:.3}},yAxisIndex:1},{name:"benchmark",type:"line",data:[],lineStyle:{normal:{color:"#2f4554"}},areaStyle:{normal:{color:"#2f4554",opacity:.3}},yAxisIndex:1}]},chartOptions2:{title:{},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:20,left:0,right:10,bottom:0},xAxis:[{type:"category",data:[]}],yAxis:[{type:"value",axisLabel:{inside:!0,verticalAlign:"bottom"},axisTick:{inside:!0},position:"right",axisLine:{lineStyle:{color:"#999"}},splitLine:{show:!0,lineStyle:{color:["rgba(80,80,80, 0.7)"],type:"dashed"}}}],series:[{name:"monthporfit",type:"bar",data:[],itemStyle:{normal:{color:function(t){return t.value<0?"#51b9b8":"#c23531"},opacity:.6}}}]}}},watch:{size:{handler:function(t){(this.chart1||this.chart2)&&(this.chart1.resize({width:t.width,height:t.height}),this.chart2.resize({width:t.width,height:t.height}))},deep:!0}},methods:{initChart:function(){this.chart1=this.$echarts.init(document.getElementById("chart1")),this.chart1.setOption(this.chartOptions1),this.chart2=this.$echarts.init(document.getElementById("chart2")),this.chart2.setOption(this.chartOptions2)}}},s=r,n=(i("1886"),i("5d22")),c=Object(n["a"])(s,a,o,!1,null,null,null);e["default"]=c.exports},f8f8:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("d2-container",{attrs:{type:"full"}},[i("div",{ref:"QIFIbacktest",staticClass:"QIFIbacktest"},[i("div",{staticClass:"left card"},[i("p",[t._v("组合")]),i("ul",t._l(t.portfolio_list,(function(e,a){return i("li",{key:a,class:{active:t.curLi===a},on:{click:function(i){return t.selectLi(e,a)}}},[t._v(t._s(e))])})),0)]),i("div",{staticClass:"center"},[i("div",{staticClass:"center-top card"},[i("backtest-echart",{ref:"backtestEchart"})],1),i("div",{staticClass:"center-bottom card"},[i("div",{staticClass:"accountTitle"},[i("h2",[t._v("账户")]),i("el-input",{staticClass:"accountInput",attrs:{placeholder:"请输入账户",clearable:""},on:{input:t.inputSearch},model:{value:t.accountValue,callback:function(e){t.accountValue=e},expression:"accountValue"}})],1),i("vxe-table",{style:{width:t.accountTabWidth},attrs:{border:"","show-header-overflow":"","show-overflow":"","highlight-hover-row":"",data:t.searchAccountData,height:"300","auto-resize":"","sort-config":{trigger:"cell"}},on:{"cell-click":t.selectAccount},scopedSlots:t._u([{key:"empty",fn:function(){return[i("span",[i("img",{attrs:{src:"https://xuliangzhan_admin.gitee.io/vxe-table/static/other/img2.gif"}}),i("p",[t._v("不是吧！这就没数据了")])])]},proxy:!0}])},[i("vxe-table-column",{staticClass:"active",attrs:{field:"user_id",title:"账户id","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{class:e.row.balance-e.row.pre_balance>=0?e.row.balance-e.row.pre_balance===0?"":"profit":"loss"},[t._v(t._s(e.row.user_id))])]}}])}),i("vxe-table-column",{attrs:{field:"pre_balance",title:"初始资金",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t._f("toFixed")(e.row.pre_balance)))])]}}])}),i("vxe-table-column",{attrs:{field:"balance",title:"当前权益",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t._f("toFixed")(e.row.balance)))])]}}])}),i("vxe-table-column",{attrs:{field:"available",title:"可用资金",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t._f("toFixed")(e.row.available)))])]}}])}),i("vxe-table-column",{attrs:{field:"float_profit",title:"浮动盈亏",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{class:e.row.float_profit>=0?0===e.row.float_profit?"":"profit":"loss"},[t._v(t._s(t._f("toFixed")(e.row.float_profit)))])]}}])}),i("vxe-table-column",{attrs:{field:"close_profit",title:"平仓盈亏",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{class:e.row.close_profit>=0?0===e.row.close_profit?"":"profit":"loss"},[t._v(t._s(t._f("toFixed")(e.row.close_profit)))])]}}])}),i("vxe-table-column",{attrs:{field:"WithdrawQuota",title:"可取资金",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t._f("toFixed")(e.row.WithdrawQuota)))])]}}])}),i("vxe-table-column",{attrs:{field:"margin",title:"保证金",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t._f("toFixed")(e.row.margin)))])]}}])})],1)],1)]),i("div",{staticClass:"right"},[i("h1",{staticClass:"right-top card"},[t._v(t._s(t.accountCookie))]),i("div",{staticClass:"right-bottom card"},[i("vxe-table",{attrs:{border:"","show-header-overflow":"","show-overflow":"","highlight-hover-row":"",data:t.trade,height:t.tradeHeight,"sort-config":{trigger:"cell"}},on:{"cell-click":t.navigateKline}},[i("vxe-table-column",{attrs:{field:"code",title:"代码"}}),i("vxe-table-column",{attrs:{field:"direction",title:"方向"}}),i("vxe-table-column",{attrs:{field:"offset",title:"标志"}}),i("vxe-table-column",{attrs:{field:"price",title:"价格"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[i("span",[t._v(t._s(t._f("toFixed")(a.price)))])]}}])}),i("vxe-table-column",{attrs:{field:"volume",title:"手数"}}),i("vxe-table-column",{attrs:{field:"commission",title:"手续费"}}),i("vxe-table-column",{attrs:{field:"datetime",title:"时间","min-width":"80px"}})],1)],1)])])])},o=[],r=(i("cb3c"),i("b131"),i("d0bf"),i("cb60"),i("7478"),i("fae2"),i("b5eb"),i("e583"),i("0bd5"),i("836b"),i("6a61"),i("2e91")),s=i("dded"),n={name:"demo-backtest-qifi",data:function(){return{curLi:0,tradeHeight:0,accountValue:"",backtestqifiURL:"",accountlist:[],searchAccountData:[],portfolio_list:[],trade:[],portfolio:"",accountCookie:"",assets:{},monthprofit:{},accountTabWidth:""}},components:{backtestEchart:s["default"]},mounted:function(){this.monitor(),this.getPortfoliolist()},filters:{toFixed:function(t){return Number.isInteger(t)?t:t.toFixed(2)}},methods:{monitor:function(){var t=this;this.$erd.listenTo(this.$refs.QIFIbacktest,(function(e){var i=e.offsetWidth,a=e.offsetHeight;t.$refs.backtestEchart.size={width:i-800+"px",height:(a-372)/2+"px"},t.accountTabWidth=i-800+"px",t.tradeHeight=a-70}))},selectLi:function(t,e){this.portfolio=t,this.curLi=e,this.getAccountlist(t)},selectAccount:function(t){var e=t.row;this.init_strategy(e.user_id)},navigateKline:function(){var t=this.$router.resolve({name:"klineChart"});window.open(t.href+"?account_cookie="+this.accountCookie+"&portfolio_cookie="+this.portfolio+"&market=future_cn&frequence=1min","_blank")},inputSearch:function(){var t=new RegExp(this.accountValue,"i");this.searchAccountData=this.accountlist.filter((function(e,i){return t.test(e.user_id)}))},getPortfoliolist:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$api.getPortfoliolist({action:"portfoliolist"});case 2:i=e.sent,a=i.res,t.portfolio_list=a,t.portfolio=t.portfolio_list[0],t.getAccountlist(t.portfolio_list[0]);case 7:case"end":return e.stop()}}),e)})))()},getAccountlist:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a,o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.$api.getPortfoliolist({action:"accountinportfolio",portfolio:t});case 2:a=i.sent,o=a.res,e.accountlist=o,e.searchAccountData=e.accountlist.slice(0),e.init_strategy(e.accountlist[0].user_id);case 7:case"end":return i.stop()}}),i)})))()},getAssetsthistory:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a,o,r,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.$api.getAssetsthistory({action:"acchistory",account_cookie:t});case 2:a=i.sent,o=a.res,e.assets=o,r=Object.keys(e.assets),s=Object.values(e.assets),e.$refs.backtestEchart.chartOptions1.series[0].data=s,e.$refs.backtestEchart.chartOptions1.xAxis.data=r,e.$refs.backtestEchart.initChart();case 10:case"end":return i.stop()}}),i)})))()},getTrade:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a,o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.$api.getAssetsthistory({action:"historytrade",account_cookie:t});case 2:a=i.sent,o=a.res,e.trade=o;case 5:case"end":return i.stop()}}),i)})))()},getMonthprofit:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var a,o,r,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.$api.getAssetsthistory({action:"monthprofit",account_cookie:t});case 2:a=i.sent,o=a.res,e.monthprofit=o,r=Object.keys(e.monthprofit),s=Object.values(e.monthprofit),e.$refs.backtestEchart.chartOptions2.series[0].data=s,e.$refs.backtestEchart.chartOptions2.xAxis[0].data=r,e.$refs.backtestEchart.initChart();case 10:case"end":return i.stop()}}),i)})))()},reset_data:function(){this.trade=[],this.account_account="",this.assets={},this.monthprofit={}},init_strategy:function(t){this.reset_data(),this.accountCookie=t,this.getTrade(t),this.getAssetsthistory(t),this.getMonthprofit(t)}}},c=n,l=(i("b035"),i("5d22")),u=Object(l["a"])(c,a,o,!1,null,"81ce4634",null);e["default"]=u.exports}}]);